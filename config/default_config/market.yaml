# 市场动态定价配置（增强版本 v2.0）
# 配置动态定价机制的各项参数，支持大规模数据处理和性能优化

# 全局开关
enabled: true

# 价格调整参数（纯供应驱动模式）
pricing:
  sensitivity: 0.1 # 价格敏感度系数K
  min_ratio: 0.5 # 最小价格比率（基准价的50%）
  max_ratio: 1.5 # 最大价格比率（基准价的150%）
  sell_price_ratio: 0.5 # 售价比例（相对于买价）
  stability_threshold: 2 # 价格稳定性判断阈值（百分比）
  extreme_ratio_max: 10 # 极端供需比上限
  extreme_ratio_min: 0.1 # 极端供需比下限
  min_base_supply: 1 # 基准供应量下限（防止除零）
  history_days: 7 # 供应历史记录天数
  # 市场情绪扰动配置
  market_sentiment:
    enabled: true # 是否启用随机扰动
    volatility: 0.05 # 波动率σ
    max_noise: 0.15 # 截断阈值±15%

# 批量处理配置（新增）
batch_size: 100 # 默认批次大小

# 浮动价格物品配置
floating_items:
  # 基于类别的物品
  categories:
    - crops # 作物类别

  # 特定物品ID列表（如果需要特别指定某些物品）
  items:
    - carrot # 胡萝卜
    - tomato # 西红柿
    - wheat # 小麦

# 监控和告警（增强版本）
monitoring:
  enabled: true # 是否启用监控
  price_change_threshold: 0.3 # 价格变化超过30%时告警
  extreme_ratio_threshold: 2.0 # 供需比极端值告警阈值

# 任务调度器配置（增强版）
scheduler:
  enabled: true # 是否启用任务调度器
  max_concurrent_tasks: 3 # 最大并发任务数
  task_timeout: 300 # 任务超时时间（秒）
  retry_attempts: 2 # 任务重试次数
  lock_ttl: 600 # 分布式锁TTL（秒）
  # 任务定义配置 - 支持配置驱动的任务管理
  tasks:
    - name: dailyPriceUpdate
      type: daily # 每日定时任务
      hour: 4 # 执行时间：04:00
      minute: 0
      timeout: 300 # 5分钟超时（秒）
      retry_attempts: 2 # 重试2次
      enabled: true # 启用任务
      description: "每日价格更新任务（归档供应历史+计算新价格+重置计数器）"

    - name: monitoring
      type: interval # 间隔执行任务
      interval: 1800 # 30分钟（秒）
      timeout: 120 # 2分钟超时（秒）
      retry_attempts: 1 # 重试1次
      enabled: true # 启用任务
      description: "市场监控任务"

# 事务配置
transaction:
  lock_timeout: 600 # 事务锁超时时间（秒）
  max_retries: 2 # 事务最大重试次数
  retry_delay: 1 # 事务重试延迟（秒）

# 价格历史
history:
  max_records: 168 # 最大历史记录数（7天 * 24小时）
