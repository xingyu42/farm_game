<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>农场主排行榜</title>
    <link rel="stylesheet" href="../common/lib/daisyui.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="../common/lib/vue.js"></script>
    <script src="../common/lib/unocss.js"></script>
    <script src="../common/lib/iconify.js"></script>
    <style>
        [v-cloak] { display: none; }
        * { font-family: 'Outfit', system-ui, sans-serif; }

        .podium-1 { transform: translateY(-8px); }
        .podium-2 { transform: translateY(0); }
        .podium-3 { transform: translateY(4px); }
    </style>
</head>
<body class="w-220" style="background: linear-gradient(180deg, #f0fdf4 0%, #fafafa 100%);">

<div id="app" v-cloak class="w-220 p-6">

    <!-- 主容器 -->
    <div class="relative">

        <!-- 装饰背景 -->
        <div class="absolute -top-4 -right-4 w-32 h-32 rounded-full opacity-40"
            style="background: radial-gradient(circle, rgba(16, 185, 129, 0.15) 0%, transparent 70%);"></div>
        <div class="absolute -bottom-4 -left-4 w-24 h-24 rounded-full opacity-30"
            style="background: radial-gradient(circle, rgba(251, 191, 36, 0.2) 0%, transparent 70%);"></div>

        <!-- 主卡片 -->
        <div class="relative bg-white/90 backdrop-blur-sm rounded-3xl overflow-hidden"
            style="box-shadow: 0 1px 2px rgba(0,0,0,0.02), 0 4px 8px rgba(0,0,0,0.03), 0 16px 32px rgba(0,0,0,0.04), 0 32px 64px rgba(0,0,0,0.02);">

            <!-- 顶部装饰线 -->
            <div class="h-1" style="background: linear-gradient(90deg, #10b981 0%, #34d399 50%, #fbbf24 100%);"></div>

            <!-- 标题区 -->
            <header class="px-7 pt-6 pb-5">
                <div class="flex items-end justify-between">
                    <div>
                        <div class="flex items-center gap-2 mb-1">
                            <div class="w-1.5 h-1.5 rounded-full bg-emerald-500"></div>
                            <span class="text-2.5 font-medium tracking-widest text-emerald-600/80 uppercase">Leaderboard</span>
                        </div>
                        <h1 class="text-5 font-bold text-gray-800 tracking-tight">农场主排行榜</h1>
                    </div>
                    <div class="flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-gray-50 border border-gray-100">
                        <span class="iconify text-3.5 text-gray-400" data-icon="ph:users-three"></span>
                        <span class="text-2.5 font-semibold text-gray-500">{{ totalPlayers }}</span>
                    </div>
                </div>
            </header>

            <!-- 排行榜内容 -->
            <div class="px-5 pb-5">

                <!-- 空状态 -->
                <div v-if="ranking.length === 0" class="py-20 text-center">
                    <div class="relative inline-block">
                        <div class="w-20 h-20 mx-auto rounded-2xl bg-gradient-to-br from-gray-50 to-gray-100
                            flex items-center justify-center border border-gray-100">
                            <span class="iconify text-10 text-gray-300" data-icon="ph:plant-light"></span>
                        </div>
                        <div class="absolute -bottom-1 -right-1 w-6 h-6 rounded-full bg-white border border-gray-100
                            flex items-center justify-center">
                            <span class="iconify text-3 text-gray-300" data-icon="ph:question"></span>
                        </div>
                    </div>
                    <p class="text-3.5 font-semibold text-gray-400 mt-5">暂无排行数据</p>
                    <p class="text-2.5 text-gray-300 mt-1">快去发展你的农场吧</p>
                </div>

                <!-- 领奖台 Top 3 -->
                <div v-if="ranking.length > 0" class="flex items-end justify-center gap-3 mb-6 pt-6">

                    <!-- 第二名 -->
                    <div class="flex-1 max-w-36 podium-2">
                        <div v-if="ranking[1]" class="relative p-4 rounded-2xl border-2 border-gray-200 overflow-visible"
                            style="background: linear-gradient(to bottom, #ffffff, #f9fafb);">
                            <div class="absolute -top-3 left-1/2 -translate-x-1/2 w-7 h-7 rounded-full flex items-center justify-center"
                                style="background: linear-gradient(to bottom, #9ca3af, #6b7280); box-shadow: 0 2px 6px rgba(0,0,0,0.25);">
                                <span class="text-3 font-bold text-white">2</span>
                            </div>
                            <div class="pt-3 text-center">
                                <div class="text-3.5 font-bold text-gray-700 truncate">{{ ranking[1].name }}</div>
                                <div class="flex items-center justify-center gap-1.5 mt-1.5 text-2.5 text-gray-400">
                                    <span>Lv{{ ranking[1].level }}</span>
                                    <span class="w-0.5 h-0.5 rounded-full bg-gray-300"></span>
                                    <span>{{ ranking[1].landCount }}地</span>
                                </div>
                                <div v-if="hasQuality(ranking[1])" class="flex items-center justify-center gap-2 mt-2 text-2.5">
                                    <span v-if="ranking[1].qualityCounts?.red" class="flex items-center gap-0.5">
                                        <span class="w-2 h-2 rounded-full" style="background:#f87171;"></span>
                                        <span class="text-gray-500">{{ ranking[1].qualityCounts.red }}</span>
                                    </span>
                                    <span v-if="ranking[1].qualityCounts?.black" class="flex items-center gap-0.5">
                                        <span class="w-2 h-2 rounded-full" style="background:#374151;"></span>
                                        <span class="text-gray-500">{{ ranking[1].qualityCounts.black }}</span>
                                    </span>
                                    <span v-if="ranking[1].qualityCounts?.gold" class="flex items-center gap-0.5">
                                        <span class="w-2 h-2 rounded-full" style="background:#fbbf24;"></span>
                                        <span class="text-gray-500">{{ ranking[1].qualityCounts.gold }}</span>
                                    </span>
                                </div>
                                <div class="text-2.5 text-gray-400 mt-2">{{ formatNumber(ranking[1].totalAssets) }}</div>
                                <div class="mt-2 pt-2 border-t border-gray-100">
                                    <div class="text-4.5 font-bold text-gray-600">{{ formatNumber(ranking[1].score) }}</div>
                                </div>
                            </div>
                        </div>
                        <div v-else class="p-6 rounded-2xl border-2 border-dashed border-gray-100 text-center">
                            <span class="text-2.5 text-gray-300">虚位以待</span>
                        </div>
                    </div>

                    <!-- 第一名 (冠军) -->
                    <div class="flex-1 max-w-40 podium-1">
                        <div v-if="ranking[0]" class="relative p-5 rounded-2xl border-2 border-amber-200 overflow-visible"
                            style="background: linear-gradient(to bottom, #fffbeb, #ffffff); box-shadow: 0 4px 20px rgba(251, 191, 36, 0.2);">
                            <div class="absolute -top-5 left-1/2 -translate-x-1/2">
                                <span class="iconify text-10 text-amber-400" data-icon="ph:crown-fill" style="filter: drop-shadow(0 2px 4px rgba(251, 191, 36, 0.5));"></span>
                            </div>
                            <div class="pt-5 text-center">
                                <div class="text-4 font-bold text-amber-800 truncate">{{ ranking[0].name }}</div>
                                <div class="flex items-center justify-center gap-1.5 mt-2 text-2.5 text-amber-600/70">
                                    <span>Lv{{ ranking[0].level }}</span>
                                    <span class="w-0.5 h-0.5 rounded-full bg-amber-400"></span>
                                    <span>{{ ranking[0].landCount }}地</span>
                                </div>
                                <div v-if="hasQuality(ranking[0])" class="flex items-center justify-center gap-2 mt-2 text-2.5">
                                    <span v-if="ranking[0].qualityCounts?.red" class="flex items-center gap-0.5">
                                        <span class="w-2 h-2 rounded-full" style="background:#f87171;"></span>
                                        <span class="text-amber-700/70">{{ ranking[0].qualityCounts.red }}</span>
                                    </span>
                                    <span v-if="ranking[0].qualityCounts?.black" class="flex items-center gap-0.5">
                                        <span class="w-2 h-2 rounded-full" style="background:#374151;"></span>
                                        <span class="text-amber-700/70">{{ ranking[0].qualityCounts.black }}</span>
                                    </span>
                                    <span v-if="ranking[0].qualityCounts?.gold" class="flex items-center gap-0.5">
                                        <span class="w-2 h-2 rounded-full" style="background:#fbbf24;"></span>
                                        <span class="text-amber-700/70">{{ ranking[0].qualityCounts.gold }}</span>
                                    </span>
                                </div>
                                <div class="text-2.5 text-amber-600/60 mt-2">{{ formatNumber(ranking[0].totalAssets) }}</div>
                                <div class="mt-3 pt-3 border-t border-amber-200/50">
                                    <div class="text-5 font-bold text-amber-600">{{ formatNumber(ranking[0].score) }}</div>
                                    <div class="text-2 text-amber-500/60 mt-0.5 font-medium">Champion</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 第三名 -->
                    <div class="flex-1 max-w-36 podium-3">
                        <div v-if="ranking[2]" class="relative p-4 rounded-2xl border-2 border-orange-200 overflow-visible"
                            style="background: linear-gradient(to bottom, #fff7ed, #ffffff);">
                            <div class="absolute -top-3 left-1/2 -translate-x-1/2 w-7 h-7 rounded-full flex items-center justify-center"
                                style="background: linear-gradient(to bottom, #fb923c, #ea580c); box-shadow: 0 2px 6px rgba(0,0,0,0.25);">
                                <span class="text-3 font-bold text-white">3</span>
                            </div>
                            <div class="pt-3 text-center">
                                <div class="text-3.5 font-bold text-orange-800 truncate">{{ ranking[2].name }}</div>
                                <div class="flex items-center justify-center gap-1.5 mt-1.5 text-2.5 text-orange-500/70">
                                    <span>Lv{{ ranking[2].level }}</span>
                                    <span class="w-0.5 h-0.5 rounded-full bg-orange-300"></span>
                                    <span>{{ ranking[2].landCount }}地</span>
                                </div>
                                <div v-if="hasQuality(ranking[2])" class="flex items-center justify-center gap-2 mt-2 text-2.5">
                                    <span v-if="ranking[2].qualityCounts?.red" class="flex items-center gap-0.5">
                                        <span class="w-2 h-2 rounded-full" style="background:#f87171;"></span>
                                        <span class="text-orange-600/70">{{ ranking[2].qualityCounts.red }}</span>
                                    </span>
                                    <span v-if="ranking[2].qualityCounts?.black" class="flex items-center gap-0.5">
                                        <span class="w-2 h-2 rounded-full" style="background:#374151;"></span>
                                        <span class="text-orange-600/70">{{ ranking[2].qualityCounts.black }}</span>
                                    </span>
                                    <span v-if="ranking[2].qualityCounts?.gold" class="flex items-center gap-0.5">
                                        <span class="w-2 h-2 rounded-full" style="background:#fbbf24;"></span>
                                        <span class="text-orange-600/70">{{ ranking[2].qualityCounts.gold }}</span>
                                    </span>
                                </div>
                                <div class="text-2.5 text-orange-500/60 mt-2">{{ formatNumber(ranking[2].totalAssets) }}</div>
                                <div class="mt-2 pt-2 border-t border-orange-100">
                                    <div class="text-4.5 font-bold text-orange-600">{{ formatNumber(ranking[2].score) }}</div>
                                </div>
                            </div>
                        </div>
                        <div v-else class="p-6 rounded-2xl border-2 border-dashed border-gray-100 text-center">
                            <span class="text-2.5 text-gray-300">虚位以待</span>
                        </div>
                    </div>
                </div>

                <!-- 其余排名列表 -->
                <div v-if="ranking.length > 3" class="rounded-2xl border border-gray-100 overflow-hidden bg-gray-50/30">
                    <div v-for="(player, idx) in ranking.slice(3)" :key="player.rank"
                        class="flex items-center gap-4 px-5 py-3.5"
                        :class="idx !== ranking.slice(3).length - 1 ? 'border-b border-gray-100/80' : ''">

                        <!-- 排名 -->
                        <div class="w-8 h-8 rounded-lg bg-white border border-gray-100
                            flex items-center justify-center shadow-sm">
                            <span class="text-3 font-bold text-gray-400">{{ player.rank }}</span>
                        </div>

                        <!-- 玩家信息 -->
                        <div class="flex-1 min-w-0">
                            <div class="font-semibold text-3.5 text-gray-700 truncate">{{ player.name }}</div>
                            <div class="flex items-center gap-2 mt-0.5">
                                <span class="text-2.5 text-gray-400">Lv{{ player.level }}</span>
                                <span class="text-gray-200">|</span>
                                <span class="text-2.5 text-gray-400">{{ player.landCount }}块地</span>
                                <div v-if="hasQuality(player)" class="flex items-center gap-1.5 ml-2 text-2.5">
                                    <span v-if="player.qualityCounts?.red" class="flex items-center gap-0.5">
                                        <span class="w-1.5 h-1.5 rounded-full" style="background:#f87171;"></span>
                                        <span class="text-gray-400">{{ player.qualityCounts.red }}</span>
                                    </span>
                                    <span v-if="player.qualityCounts?.black" class="flex items-center gap-0.5">
                                        <span class="w-1.5 h-1.5 rounded-full" style="background:#374151;"></span>
                                        <span class="text-gray-400">{{ player.qualityCounts.black }}</span>
                                    </span>
                                    <span v-if="player.qualityCounts?.gold" class="flex items-center gap-0.5">
                                        <span class="w-1.5 h-1.5 rounded-full" style="background:#fbbf24;"></span>
                                        <span class="text-gray-400">{{ player.qualityCounts.gold }}</span>
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- 资产 -->
                        <div class="text-right px-3">
                            <div class="text-2 text-gray-300 font-medium">资产</div>
                            <div class="text-2.5 text-gray-500 font-semibold">{{ formatNumber(player.totalAssets) }}</div>
                        </div>

                        <!-- 评分 -->
                        <div class="w-18 text-right">
                            <div class="inline-flex items-center gap-1 px-2.5 py-1 rounded-lg bg-emerald-50 border border-emerald-100">
                                <span class="text-3.5 font-bold text-emerald-600">{{ formatNumber(player.score) }}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 我的排名 -->
                <div v-if="self && !selfInList" class="mt-4">
                    <div class="relative flex items-center gap-4 px-5 py-4 rounded-2xl overflow-hidden
                        bg-gradient-to-r from-emerald-50 to-teal-50 border-2 border-emerald-200/50">

                        <div class="absolute top-0 right-0 w-32 h-32 opacity-10"
                            style="background: radial-gradient(circle at top right, #10b981, transparent 70%);"></div>

                        <div class="w-10 h-10 rounded-xl bg-white border-2 border-emerald-200
                            flex items-center justify-center shadow-sm">
                            <span class="text-3.5 font-bold text-emerald-500">{{ self.rank }}</span>
                        </div>

                        <div class="flex-1 min-w-0">
                            <div class="flex items-center gap-2">
                                <span class="font-bold text-3.5 text-emerald-800 truncate">{{ self.name }}</span>
                                <span class="px-2 py-0.5 rounded-full bg-emerald-500 text-white text-2 font-semibold shadow-sm">ME</span>
                            </div>
                            <div class="text-2.5 text-emerald-600/60 mt-0.5 font-medium">
                                Lv{{ self.level }} · {{ self.landCount || 0 }}块地
                            </div>
                        </div>

                        <div class="text-right">
                            <div class="text-2 text-emerald-500/60 font-medium">综合评分</div>
                            <div class="text-4.5 font-bold text-emerald-600">{{ formatNumber(self.score) }}</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 底部信息 -->
            <footer class="px-6 py-4 border-t border-gray-100 bg-gray-50/50">
                <div class="flex items-center gap-2 text-2.5 text-gray-400">
                    <span class="iconify text-3" data-icon="ph:lightbulb"></span>
                    <span>评分 = 土地×100 + 品质加成×200 + 等级×150 + log₁₀(资产)×1000</span>
                </div>
            </footer>
        </div>
    </div>
</div>

<script>
// 测试数据
window.FARM_DATA = {
    ranking: [
        { rank: 1, name: '金牌农场主', level: 50, landCount: 24, totalAssets: 2580000, score: 18650, qualityCounts: { normal: 8, red: 6, black: 6, gold: 4 } },
        { rank: 2, name: '丰收大师', level: 45, landCount: 20, totalAssets: 1850000, score: 15420, qualityCounts: { normal: 10, red: 5, black: 3, gold: 2 } },
        { rank: 3, name: '快乐小农', level: 42, landCount: 18, totalAssets: 1320000, score: 13280, qualityCounts: { normal: 12, red: 4, black: 2, gold: 0 } },
        { rank: 4, name: '田园牧歌', level: 38, landCount: 16, totalAssets: 980000, score: 11540, qualityCounts: { normal: 12, red: 3, black: 1, gold: 0 } },
        { rank: 5, name: '向日葵', level: 35, landCount: 14, totalAssets: 756000, score: 9870, qualityCounts: { normal: 11, red: 2, black: 1, gold: 0 } },
        { rank: 6, name: '春风十里', level: 32, landCount: 12, totalAssets: 520000, score: 8320, qualityCounts: { normal: 10, red: 2, black: 0, gold: 0 } },
        { rank: 7, name: '稻花香', level: 28, landCount: 10, totalAssets: 385000, score: 7150, qualityCounts: { normal: 9, red: 1, black: 0, gold: 0 } },
        { rank: 8, name: '麦浪', level: 25, landCount: 9, totalAssets: 278000, score: 6280, qualityCounts: { normal: 8, red: 1, black: 0, gold: 0 } },
        { rank: 9, name: '绿野仙踪', level: 22, landCount: 8, totalAssets: 186000, score: 5420, qualityCounts: { normal: 8, red: 0, black: 0, gold: 0 } },
        { rank: 10, name: '小菜园', level: 18, landCount: 6, totalAssets: 95000, score: 4180, qualityCounts: { normal: 6, red: 0, black: 0, gold: 0 } },
    ],
    self: { rank: 23, name: '我的农场', level: 12, landCount: 4, totalAssets: 35600, score: 2850 },
    selfInList: false,
    totalPlayers: 156
};

const { createApp, ref, onMounted } = Vue;

createApp({
    setup() {
        const data = window.FARM_DATA || {};

        const ranking = ref(data.ranking || []);
        const self = ref(data.self || null);
        const selfInList = ref(data.selfInList || false);
        const totalPlayers = ref(data.totalPlayers || 0);

        const hasQuality = (player) => {
            const q = player.qualityCounts;
            return q && (q.red || q.black || q.gold);
        };

        const formatNumber = (num) => {
            if (num === null || num === undefined) return '0';
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toLocaleString();
        };

        onMounted(() => document.body.classList.add('ready'));

        return {
            ranking,
            self,
            selfInList,
            totalPlayers,
            hasQuality,
            formatNumber
        };
    }
}).mount('#app');
</script>

</body>
</html>
